var route=function(t){"use strict";function e(t){return t.split(/[/?#]/)}function n(t,e){var n=e.replace(/\?/g,"\\?").replace(/\*/g,"([^/?#]+?)").replace(/\.\./,".*"),r=new RegExp("^"+n+"$"),i=t.match(r);if(i)return i.slice(1)}function r(t,e){var n;return function(){clearTimeout(n),n=setTimeout(t,e)}}function i(t){p=r(s,1),L[w]($,p),L[w](A,p),O[w](j,l),t&&s(!0)}function o(){this.$=[],y(this),k.on("stop",this.s.bind(this)),k.on("emit",this.e.bind(this))}function u(t){return t.replace(/^\/|\/$/,"")}function a(t){return"string"==typeof t}function c(t){return(t||K.href).replace(b,"")}function f(t){return"#"===d[0]?(t||K.href||"").split(d)[1]||"":(K?c(t):t||"").replace(d,"")}function s(t){var e=0===R;if(!(x<=R)&&(R++,D.push(function(){var e=f();(t||e!==v)&&(k[S]("emit",e),v=e)}),e)){for(var n;n=D.shift();)n();R=0}}function l(t){if(!(1!==t.which||t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)){for(var e=t.target;e&&"A"!==e.nodeName;)e=e.parentNode;!e||"A"!==e.nodeName||e[E]("download")||!e[E]("href")||e.target&&"_self"!==e.target||-1===e.href.indexOf(K.href.match(b)[0])||e.href!==K.href&&(e.href.split("#")[0]===K.href.split("#")[0]||"#"!==d[0]&&0!==c(e.href).indexOf(d)||"#"===d[0]&&e.href.split(d)[0]!==K.href.split(d)[0]||!h(f(e.href),e.title||O.title))||t.preventDefault()}}function h(t,e,n){return T?(t=d+u(t),e=e||O.title,n?T.replaceState(null,e,t):T.pushState(null,e,t),O.title=e,q=!1,s(),q):k[S]("emit",f(t))}t="default"in t?t.default:t;var p,d,v,m,g,y=function(t){t=t||{};var e={},n=Array.prototype.slice;return Object.defineProperties(t,{on:{value:function(n,r){return"function"==typeof r&&(e[n]=e[n]||[]).push(r),t},enumerable:!1,writable:!1,configurable:!1},off:{value:function(n,r){if("*"!=n||r)if(r)for(var i,o=e[n],u=0;i=o&&o[u];++u)i==r&&o.splice(u--,1);else delete e[n];else e={};return t},enumerable:!1,writable:!1,configurable:!1},one:{value:function(e,n){function r(){t.off(e,r),n.apply(t,arguments)}return t.on(e,r)},enumerable:!1,writable:!1,configurable:!1},trigger:{value:function(r){var i,o,u,a=arguments,c=arguments.length-1,f=new Array(c);for(u=0;u<c;u++)f[u]=a[u+1];for(i=n.call(e[r]||[],0),u=0;o=i[u];++u)o.apply(t,f);return e["*"]&&"*"!=r&&t.trigger.apply(t,["*",r].concat(f)),t},enumerable:!1,writable:!1,configurable:!1}}),t},b=/^.+?\/\/+[^\/]+/,w="addEventListener",E="hasAttribute",$="popstate",A="hashchange",S="trigger",x=3,L="undefined"!=typeof window&&window,O="undefined"!=typeof document&&document,T=L&&history,K=L&&(T.location||L.location),N=o.prototype,j=O&&O.ontouchstart?"touchstart":"click",k=y(),P=!1,q=!1,D=[],R=0;N.m=function(t,e,n){!a(t)||e&&!a(e)?e?this.r(t,e):this.r("@",t):h(t,e,n||!1)},N.s=function(){this.off("*"),this.$=[]},N.e=function(t){this.$.concat("@").some(function(e){var n=("@"===e?m:g)(u(t),u(e));if(void 0!==n)return this[S].apply(null,[e].concat(n)),q=!0},this)},N.r=function(t,e){"@"!==t&&(t="/"+u(t),this.$.push(t)),this.on(t,e)};var _=new o,z=_.m.bind(_);return z.create=function(){var t=new o,e=t.m.bind(t);return e.stop=t.s.bind(t),e},z.base=function(t){d=t||"#",v=f()},z.exec=function(){s(!0)},z.parser=function(t,r){t||r||(m=e,g=n),t&&(m=t),r&&(g=r)},z.query=function(){var t={};return(K.href||v).replace(/[?&](.+?)=([^&]*)/g,function(e,n,r){t[n]=r}),t},z.stop=function(){P&&(L&&(L.removeEventListener($,p),L.removeEventListener(A,p),O.removeEventListener(j,l)),k[S]("stop"),P=!1)},z.start=function(t){P||(L&&("interactive"===document.readyState||"complete"===document.readyState?i(t):document.onreadystatechange=function(){"interactive"===document.readyState&&setTimeout(function(){i(t)},1)}),P=!0)},z.base(),z.parser(),t.tag2("router","<yield></yield>","","",function(t){var e=this;this.route=z.create(),this.select=function(t){[].concat(e.tags.route).forEach(function(e){return e.show=e===t})},this.on("mount",function(){window.setTimeout(function(){return z.start(!0)},0)}),this.on("unmount",function(){this.route.stop()})}),t.tag2("route",'<virtual if="{show}"><yield></yield></virtual>',"","",function(t){function e(t){return Object.keys(t).map(function(e){return t[e]}).reduce(function(t,e){return t.concat(e)},[])}var n=this;this.show=!1,this.parent.route(t.path,function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];n.one("updated",function(){e(n.tags).forEach(function(e){e.trigger.apply(e,["route"].concat(t)),e.update()})}),n.parent.select(n),n.parent.update()})}),z}(riot);